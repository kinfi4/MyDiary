(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{12:function(e,t,n){e.exports={topPanel:"fullRecordRead_topPanel__l2ur3",buttonsBlock:"fullRecordRead_buttonsBlock__3yfk7",manageButton:"fullRecordRead_manageButton__2GM1w",recordTitle:"fullRecordRead_recordTitle__2i-_p",recordBody:"fullRecordRead_recordBody__kGYWa",buttonPanel:"fullRecordRead_buttonPanel__3RsGx",createdAt:"fullRecordRead_createdAt__ihhIJ"}},13:function(e,t,n){e.exports={inner:"fullRecordUpdateCreate_inner__2QqHa",topPanel:"fullRecordUpdateCreate_topPanel__3nHhu",bodyBlock:"fullRecordUpdateCreate_bodyBlock__2zszO",titleInput:"fullRecordUpdateCreate_titleInput__21Xnx",bodyInput:"fullRecordUpdateCreate_bodyInput__cGwsI",buttonBlock:"fullRecordUpdateCreate_buttonBlock__AKFhf",saveButton:"fullRecordUpdateCreate_saveButton__2hfMD"}},19:function(e,t,n){e.exports={overflow:"fullRecordBase_overflow__J6t8D",active:"fullRecordBase_active__2kLFt",record:"fullRecordBase_record__CuQP0"}},25:function(e,t,n){e.exports={header:"header_header__3zIYV",logo:"header_logo__1OAXh",logoutButton:"header_logoutButton__oObBh"}},31:function(e,t,n){e.exports={records:"Records_records__2azxT",recordsBlock:"Records_recordsBlock__2z3pC"}},32:function(e,t,n){e.exports={card:"addRecordCard_card__2qgKP",add_sign:"addRecordCard_add_sign__1I9Sw"}},45:function(e,t,n){e.exports={notification_block:"Notifications_notification_block__2ffSL"}},46:function(e,t,n){e.exports={notification:"Notification_notification__197ow"}},48:function(e,t,n){e.exports={"lds-ring":"AnimatedPageLoading_lds-ring__1sRyI"}},50:function(e,t,n){e.exports={record:"RecordCard_record__2gN3b"}},51:function(e,t,n){e.exports={"lds-ellipsis":"AnimatedRecordsLoading_lds-ellipsis__1C7zP","lds-ellipsis1":"AnimatedRecordsLoading_lds-ellipsis1__3UTCj","lds-ellipsis2":"AnimatedRecordsLoading_lds-ellipsis2__3S3se","lds-ellipsis3":"AnimatedRecordsLoading_lds-ellipsis3__1v65G"}},85:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(20),o=n.n(c),i=(n(56),n(14)),s=n(5),d=n(16),u=n(21),l=n(22),j=n(24),b=n(23),h=n(2),f=n(7),p=n.n(f),O=n(33),m=n(13),v=n.n(m),x=n(4),g=n(0),_=Object(x.b)((function(e){return{authToken:e.auth.token}}),(function(e){return{createRecord:function(t){var n=t.title,r=t.body,a=t.authToken;return e(U({title:n,body:r,authToken:a}))},updateRecord:function(t){var n=t.title,r=t.body,a=t.authToken,c=t.id;return e(P({title:n,body:r,authToken:a,id:c}))}}}))((function(e){var t=new Date,n=t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate(),r=a.a.createRef(),c=a.a.createRef();return Object(g.jsxs)("div",{className:v.a.inner,children:[Object(g.jsxs)("div",{className:v.a.topPanel,children:[Object(g.jsx)("input",{placeholder:n,className:v.a.titleInput,max:128,ref:r,defaultValue:e.title?e.title:null}),Object(g.jsx)("div",{className:v.a.buttonBlock,children:Object(g.jsx)("button",{className:"btn btn-success "+v.a.saveButton,onClick:function(t){return function(t){var n=r.current.value,a=c.current.textContent;e.onUpdate?e.updateRecord({title:n,body:a,authToken:e.authToken,id:e.id}):e.createRecord({title:n,body:a,authToken:e.authToken})}()},children:"Save"})})]}),Object(g.jsx)("hr",{}),Object(g.jsx)("div",{className:v.a.bodyBlock,children:Object(g.jsx)("div",{contentEditable:"true","data-placeholder":"Here goes my day",className:v.a.bodyInput,ref:c,children:e.body?e.body:null})})]})})),y=n(12),R=n.n(y),k=Object(x.b)((function(e){return{authToken:e.auth.token}}),(function(e){return{deleteRecord:function(t){var n=t.id,r=t.authToken;return e(I({id:n,authToken:r}))},showUpdateWindow:function(t){var n=t.title,r=t.body,a=t.id;return e(E({title:n,body:r,id:a}))}}}))((function(e){return Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{className:R.a.topPanel,children:[Object(g.jsx)("h2",{className:R.a.recordTitle,children:e.title}),Object(g.jsxs)("div",{className:R.a.buttonsBlock,children:[Object(g.jsx)("button",{className:"btn btn-primary "+R.a.manageButton,onClick:function(){e.showUpdateWindow({title:e.title,body:e.body,id:e.id})},children:"Edit"}),Object(g.jsx)("button",{className:"btn btn-danger "+R.a.manageButton,onClick:function(){e.deleteRecord({id:e.id,authToken:e.authToken})},children:"Delete"})]})]}),Object(g.jsx)("hr",{}),Object(g.jsx)("div",{className:R.a.recordBody,children:e.body}),Object(g.jsx)("div",{className:R.a.buttonPanel,children:Object(g.jsx)("div",{className:R.a.createdAt,children:e.created})})]})})),N="SHOW_READ_RECORD",C="SHOW_WRITE_RECORD",w="HIDE_RECORD",T={fullRecordActive:!1,detailWindowContent:null},A=function(e){e({type:w})},E=function(e){var t=e.title,n=e.body,r=e.id;return function(e){e({type:w}),e({type:C,content:Object(g.jsx)(_,{onUpdate:!0,title:t,body:n,id:r})})}};p.a.defaults.xsrfHeaderName="X-CSRFTOKEN",p.a.defaults.xsrfCookieName="csrftoken";var S="CREATE_RECORD",B="DELETE_RECORD",L="UPDATE_RECORD",D={},I=function(e){var t=e.id,n=e.authToken;return function(e){p.a.delete("http://127.0.0.1:8000/api/v1/records/"+t,{headers:{Authorization:"Token ".concat(n)}}).then((function(t){return e({type:B})})).catch((function(e){return alert("Error: ".concat(e))})),e({type:w})}},U=function(e){var t=e.title,n=e.body,r=e.authToken;return function(e){var a={"Content-Type":"application/json",Authorization:"Token ".concat(r)};p.a.post("http://127.0.0.1:8000/api/v1/records",JSON.stringify({title:t,body:n}),{headers:a}).then((function(t){return e({type:S})})),e({type:w})}},P=function(e){var t=e.title,n=e.body,r=e.id,a=e.authToken;return function(e){var c=JSON.stringify({title:t,body:n});p.a.put("http://127.0.0.1:8000/api/v1/records/"+r,c,{headers:{"Content-Type":"application/json",Authorization:"Token ".concat(a)}}).then((function(t){return e({type:L})})),e({type:w})}},W="GET_RECORDS",G="LOADING_RECORDS",H="CLEAR_THE_STATE",z={records:Object(O.a)(new Set([])),current_page:0,loading:!1};p.a.defaults.xsrfHeaderName="X-CSRFTOKEN",p.a.defaults.xsrfCookieName="csrftoken";var F="USER_LOADING",J="USER_LOADED",K=" AUTH_ERROR",X="LOGIN_SUCCESS",Y="LOGIN_FAIL",M="LOGOUT",q="REGISTRATION_ERROR",Q={token:localStorage.getItem("token"),isAuthenticated:null,isLoading:!1,user:null,errors:[]};var V=n(45),Z=n.n(V),$=n(46),ee=n.n($),te=function(e){return Object(g.jsx)("div",{className:ee.a.notification,children:e.error})},ne=Object(x.b)((function(e){return{errors:e.auth.errors[0]?e.auth.errors:[]}}),(function(e){return{}}))((function(e){return Object(g.jsx)("div",{className:Z.a.notification_block,children:e.errors.map((function(e){return Object(g.jsx)(te,{error:e})}))})})),re=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={username:"",email:"",password:"",password2:""},e.onSubmit=function(t){t.preventDefault();var n=e.state,r=n.username,a=n.email,c=n.password,o=n.password2;c!==o||e.props.register(r,a,c,o)},e.onChange=function(t){return e.setState(Object(d.a)({},t.target.name,t.target.value))},e}return Object(l.a)(n,[{key:"render",value:function(){if(this.props.isAuthenticated)return Object(g.jsx)(s.a,{to:"/"});var e=this.state,t=e.username,n=e.email,r=e.password,a=e.password2;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(ne,{}),Object(g.jsx)("div",{className:"col-md-3 m-auto",children:Object(g.jsxs)("div",{className:"card card-body mt-5",children:[Object(g.jsx)("h2",{className:"text-center",children:"Register"}),Object(g.jsxs)("form",{onSubmit:this.onSubmit,children:[Object(g.jsxs)("div",{className:"form-group",children:[Object(g.jsx)("label",{children:"Username"}),Object(g.jsx)("input",{type:"text",className:"form-control",name:"username",onChange:this.onChange,value:t})]}),Object(g.jsxs)("div",{className:"form-group",children:[Object(g.jsx)("label",{children:"Email"}),Object(g.jsx)("input",{type:"email",className:"form-control",name:"email",onChange:this.onChange,value:n})]}),Object(g.jsxs)("div",{className:"form-group",children:[Object(g.jsx)("label",{children:"Password"}),Object(g.jsx)("input",{type:"password",className:"form-control",name:"password",onChange:this.onChange,value:r})]}),Object(g.jsxs)("div",{className:"form-group",children:[Object(g.jsx)("label",{children:"Confirm Password"}),Object(g.jsx)("input",{type:"password",className:"form-control",name:"password2",onChange:this.onChange,value:a})]}),Object(g.jsx)("div",{className:"form-group",children:Object(g.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Register"})}),Object(g.jsxs)("p",{children:["Already have an account? ",Object(g.jsx)(i.b,{to:"/login",children:"Login"})]})]})]})})]})}}]),n}(r.Component),ae=Object(x.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated}}),(function(e){return{register:function(t,n,r,a){return e(function(e,t,n,r){return function(a){a({type:F});var c={username:e,email:t,password1:n,password2:r};p.a.post("http://127.0.0.1:8000/api/v1/rest-auth/registration/",JSON.stringify(c),{headers:{"Content-Type":"application/json"}}).then((function(e){return a({type:X,payload:e.data})})).catch((function(e){a({type:q,errors:e.response.data})}))}}(t,n,r,a))}}}))(re),ce=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={username:"",password:""},e.onSubmit=function(t){t.preventDefault(),e.props.login(e.state.username,e.state.password)},e.onChange=function(t){return e.setState(Object(d.a)({},t.target.name,t.target.value))},e}return Object(l.a)(n,[{key:"render",value:function(){if(this.props.isAuthenticated)return Object(g.jsx)(s.a,{to:"/"});var e=this.state,t=e.username,n=e.password;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(ne,{}),Object(g.jsx)("div",{className:"col-md-3 m-auto",children:Object(g.jsxs)("div",{className:"card card-body mt-5",children:[Object(g.jsx)("h2",{className:"text-center",children:"Login"}),Object(g.jsxs)("form",{onSubmit:this.onSubmit,children:[Object(g.jsxs)("div",{className:"form-group",children:[Object(g.jsx)("label",{children:"Username"}),Object(g.jsx)("input",{type:"text",className:"form-control",name:"username",onChange:this.onChange,value:t})]}),Object(g.jsxs)("div",{className:"form-group",children:[Object(g.jsx)("label",{children:"Password"}),Object(g.jsx)("input",{type:"password",className:"form-control",name:"password",onChange:this.onChange,value:n})]}),Object(g.jsx)("div",{className:"form-group",children:Object(g.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Login"})}),Object(g.jsxs)("p",{children:["A new user? ",Object(g.jsx)(i.b,{to:"/register",children:"Register"})]})]})]})})]})}}]),n}(r.Component),oe=Object(x.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated}}),{login:function(e,t){return function(n){n({type:F});var r=JSON.stringify({username:e,password:t,email:""});p.a.post("http://127.0.0.1:8000/api/v1/rest-auth/login/",r,{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){n({type:X,payload:e.data})})).catch((function(e){n({type:Y})}))}}})(ce),ie=n(47),se=n(48),de=n.n(se),ue=function(){return Object(g.jsxs)("div",{className:de.a["lds-ring"],children:[Object(g.jsx)("div",{}),Object(g.jsx)("div",{}),Object(g.jsx)("div",{}),Object(g.jsx)("div",{})]})},le=Object(x.b)((function(e){return{auth:e.auth}}))((function(e){var t=e.component,n=e.auth,r=Object(ie.a)(e,["component","auth"]);return Object(g.jsx)(s.b,Object(h.a)(Object(h.a)({},r),{},{render:function(e){return n.isLoading?Object(g.jsx)(ue,{}):n.isAuthenticated?Object(g.jsx)(t,Object(h.a)({},e)):Object(g.jsx)(s.a,{to:"/login"})}}))})),je=n(17),be=n(49),he=Object(je.d)(Object(je.c)({records:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case G:return Object(h.a)(Object(h.a)({},e),{},{loading:!0});case W:if(0===t.recordsData.length)return Object(h.a)(Object(h.a)({},e),{},{loading:!1});var n=e.records,r=e.current_page;return Object(h.a)(Object(h.a)({},e),{},{records:Object(O.a)(new Set(n.concat(t.recordsData))),current_page:r+1,loading:!1});case S:case L:case B:return Object(h.a)(Object(h.a)({},e),{},{records:[],current_page:0,loading:!1});case H:return z;default:return Object(h.a)(Object(h.a)({},e),{},{loading:!1})}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F:return Object(h.a)(Object(h.a)({},e),{},{isLoading:!0,isAuthenticated:!1});case J:return Object(h.a)(Object(h.a)({},e),{},{isAuthenticated:!0,isLoading:!1,user:t.payload});case X:return localStorage.setItem("token",t.payload.key),Object(h.a)(Object(h.a)({},e),{},{token:t.payload.key,isAuthenticated:!0,isLoading:!1,errors:[]});case q:var n=Object.values(t.errors).flat();return{isAuthenticated:!1,isLoading:!1,token:null,user:null,errors:n};case K:case Y:return{isAuthenticated:!1,isLoading:!1,token:null,user:null,errors:["Username or password is incorrect"]};case M:return localStorage.removeItem("token"),Object(h.a)(Object(h.a)({},e),{},{token:null,user:null,isAuthenticated:!1,isLoading:!1});default:return e}},showHideRecord:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:case C:return Object(h.a)(Object(h.a)({},e),{},{fullRecordActive:!0,detailWindowContent:t.content});case w:return Object(h.a)(Object(h.a)({},e),{},{fullRecordActive:!1,detailWindowContent:null});default:return Object(h.a)({},e)}},createUpdateDeleteRecord:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:case L:case B:default:return Object(h.a)({},e)}}}),Object(je.a)(be.a)),fe=n(25),pe=n.n(fe),Oe=Object(x.b)((function(e){return{authToken:e.auth.token}}),(function(e){return{logout:function(t){return e(function(e){return function(t){t({type:H}),t({type:F}),p.a.post("http://127.0.0.1:8000/api/v1/rest-auth/logout/",{},{headers:{Authorization:"Token ".concat(e)}}).then((function(e){return t({type:M})}))}}(t))}}}))((function(e){return Object(g.jsxs)("header",{className:pe.a.header,children:[Object(g.jsx)("h2",{className:pe.a.logo,children:"DIARY"}),Object(g.jsx)("button",{className:pe.a.logoutButton+" btn btn-default",onClick:function(){return e.logout(e.authToken)},children:"Logout"})]})})),me=n(31),ve=n.n(me),xe=n(50),ge=n.n(xe),_e=Object(x.b)((function(e){return{authToken:e.auth.token}}),(function(e){return{showThisWindow:function(t){var n=t.title,r=t.body,a=t.created,c=t.id;return e(function(e){var t=e.title,n=e.body,r=e.id,a=e.created;return function(e){e({type:N,content:Object(g.jsx)(k,{body:n,title:t,created:a,id:r})})}}({title:n,body:r,created:a,id:c}))}}}))((function(e){return Object(g.jsxs)("div",{className:ge.a.record,onClick:function(){return e.showThisWindow({title:e.title,body:e.body,created:e.created,id:e.id})},children:[Object(g.jsx)("h3",{children:e.title}),Object(g.jsx)("p",{children:e.body})]})})),ye=n(32),Re=n.n(ye),ke=Object(x.b)((function(e){return{authToken:e.auth.token}}),(function(e){return{showThisWindow:function(){return e((function(e){e({type:w}),e({type:C,content:Object(g.jsx)(_,{onUpdate:!1})})}))}}}))((function(e){return Object(g.jsx)("div",{className:Re.a.card,onClick:e.showThisWindow,children:Object(g.jsx)("h1",{className:Re.a.add_sign,children:"+"})})})),Ne=n(19),Ce=n.n(Ne),we=Object(x.b)((function(e){return{active:e.showHideRecord.fullRecordActive,child:e.showHideRecord.detailWindowContent}}),(function(e){return{hideWindow:function(){return e(A)}}}))((function(e){return Object(g.jsx)("div",{className:e.active?"".concat(Ce.a.overflow," ").concat(Ce.a.active):Ce.a.overflow,onClick:function(){return e.hideWindow()},children:Object(g.jsx)("div",{className:Ce.a.record,onClick:function(e){return e.stopPropagation()},children:e.child})})})),Te=n(51),Ae=n.n(Te),Ee=function(){return Object(g.jsxs)("div",{className:Ae.a["lds-ellipsis"],children:[Object(g.jsx)("div",{}),Object(g.jsx)("div",{}),Object(g.jsx)("div",{}),Object(g.jsx)("div",{})]})},Se=Object(x.b)((function(e){return{records:e.records.records[0]?e.records.records:[],authToken:e.auth.token,current_page:e.records.current_page,loading:e.records.loading}}),(function(e){return{fetchRecords:function(t,n){e(function(e,t){return function(n){p.a.get("http://127.0.0.1:8000/api/v1/records?page="+t,{headers:{Authorization:"Token ".concat(e)}}).then((function(e){return n({type:W,recordsData:e.data})}))}}(t,n))}}}))((function(e){var t=Object(r.useRef)(),n=function(){e.fetchRecords(e.authToken,e.current_page)},a=Object(r.useCallback)((function(r){e.loading||(t.current&&t.current.disconnect(),t.current=new IntersectionObserver((function(e){e[0].isIntersecting&&n()})),r&&t.current.observe(r))}));return Object(g.jsxs)("div",{className:ve.a.records,children:[Object(g.jsx)(we,{}),Object(g.jsxs)("div",{className:ve.a.recordsBlock,children:[Object(g.jsx)(ke,{}),function(){if(0!==e.records.length)return e.records.map((function(t,n){return n===e.records.length-1?Object(g.jsx)("div",{ref:a,children:Object(g.jsx)(_e,{title:t.title,body:t.body,created:t.created,id:t.id})}):Object(g.jsx)("div",{children:Object(g.jsx)(_e,{title:t.title,body:t.body,created:t.created,id:t.id})})}));n()}()]}),e.loading&&Object(g.jsx)(Ee,{})]})})),Be=function(){return Object(g.jsxs)("div",{children:[Object(g.jsx)(Oe,{}),Object(g.jsx)(Se,{})]})};var Le=function(){return Object(r.useEffect)((function(){he.dispatch((function(e,t){e({type:F});var n={"Content-Type":"application/json",Accept:"application/json"},r=t().auth.token;r&&(n.Authorization="Token ".concat(r)),p.a.get("http://127.0.0.1:8000/api/v1/rest-auth/user",{method:"GET",headers:n}).then((function(t){200===t.status?e({type:J,payload:t.data}):e({type:K})})).catch((function(e){return e}))}))})),Object(g.jsx)(i.a,{children:Object(g.jsxs)("div",{className:"App",children:[Object(g.jsx)(le,{exact:!0,path:"/",component:Be}),Object(g.jsx)(s.b,{exact:!0,path:"/register",render:function(){return Object(g.jsx)(ae,{})}}),Object(g.jsx)(s.b,{exact:!0,path:"/login",render:function(){return Object(g.jsx)(oe,{})}})]})})},De=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,86)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))};o.a.render(Object(g.jsx)(x.a,{store:he,children:Object(g.jsx)(Le,{})}),document.getElementById("root")),De()}},[[85,1,2]]]);
//# sourceMappingURL=main.de95ce2b.chunk.js.map